theme_grey()+
theme(legend.position="bottom",
axis.text.x = element_text(angle = 90),
legend.title = element_text(size=9),
legend.text = element_text(size=7),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams
plot_nams <-ggplot(data = TabFemmesExpAN,
aes(x =annee, group = sexe,
y = value, fill = forcats::fct_relevel(mandat, c("3e mandats et+", "2e mandat", "1er mandat"), after = 1))) +
geom_col() +
labs(title = "Taux d'emploi des femmes en fonction du niveau d'éducation",
subtitle = "Lecture : En 2018, les femmes allemandes avec un niveau d'éducation élevé ont un taux d'emploi de 87 %.  \nCalculs et graphiques : Namsie d'amour",
y = "Pourcentage", x = "Secteur") +
#scale_color_manual(name = "Composante", values=c("red","grey50","grey50","grey50","grey50","grey50")) +
theme_grey()+
theme(legend.position="bottom",
axis.text.x = element_text(angle = 90),
legend.title = element_text(size=9),
legend.text = element_text(size=7),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams
plot_nams <-ggplot(data = TabFemmesExpAN,
aes(x =annee,
y = value, fill = forcats::fct_relevel(mandat, c("3e mandats et+", "2e mandat", "1er mandat"), after = 1))) +
geom_col() +
facet_wrap(~sexe)
labs(title = "Taux d'emploi des femmes en fonction du niveau d'éducation",
subtitle = "Lecture : En 2018, les femmes allemandes avec un niveau d'éducation élevé ont un taux d'emploi de 87 %.  \nCalculs et graphiques : Namsie d'amour",
y = "Pourcentage", x = "Secteur") +
#scale_color_manual(name = "Composante", values=c("red","grey50","grey50","grey50","grey50","grey50")) +
theme_grey()+
theme(legend.position="bottom",
axis.text.x = element_text(angle = 90),
legend.title = element_text(size=9),
legend.text = element_text(size=7),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams
plot_nams <-ggplot(data = TabFemmesExpAN,
aes(x =annee,
y = value, fill = forcats::fct_relevel(mandat, c("3e mandats et+", "2e mandat", "1er mandat"), after = 1))) +
geom_col() +
facet_wrap(~sexe) +
labs(title = "Taux d'emploi des femmes en fonction du niveau d'éducation",
subtitle = "Lecture : En 2018, les femmes allemandes avec un niveau d'éducation élevé ont un taux d'emploi de 87 %.  \nCalculs et graphiques : Namsie d'amour",
y = "Pourcentage", x = "Secteur") +
#scale_color_manual(name = "Composante", values=c("red","grey50","grey50","grey50","grey50","grey50")) +
theme_grey()+
theme(legend.position="bottom",
axis.text.x = element_text(angle = 90),
legend.title = element_text(size=9),
legend.text = element_text(size=7),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams
plot_nams <-ggplot(data = TabFemmesExpAN,
aes(x =annee,
y = value, fill = forcats::fct_relevel(mandat, c("3e mandats et+", "2e mandat", "1er mandat"), after = 1))) +
geom_col() +
facet_wrap(~sexe) +
labs(title = "Taux d'emploi des femmes en fonction du niveau d'éducation",
subtitle = "Lecture : En 2018, les femmes allemandes avec un niveau d'éducation élevé ont un taux d'emploi de 87 %.  \nCalculs et graphiques : Namsie d'amour",
y = "Pourcentage", x = "Année") +
#scale_color_manual(name = "Composante", values=c("red","grey50","grey50","grey50","grey50","grey50")) +
theme_grey()+
theme(legend.position="bottom",
#axis.text.x = element_text(angle = 90),
legend.title = element_text(size=12),
legend.text = element_text(size=12),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams
plot_nams <-ggplot(data = TabFemmesExpAN,
aes(x =annee,
y = value, fill = forcats::fct_relevel(mandat, c("3e mandats et+", "2e mandat", "1er mandat"), after = 1))) +
geom_col() +
facet_wrap(~sexe*annee) +
labs(title = "Taux d'emploi des femmes en fonction du niveau d'éducation",
subtitle = "Lecture : En 2018, les femmes allemandes avec un niveau d'éducation élevé ont un taux d'emploi de 87 %.  \nCalculs et graphiques : Namsie d'amour",
y = "Pourcentage", x = "Année") +
#scale_color_manual(name = "Composante", values=c("red","grey50","grey50","grey50","grey50","grey50")) +
theme_grey()+
theme(legend.position="bottom",
#axis.text.x = element_text(angle = 90),
legend.title = element_text(size=12),
legend.text = element_text(size=12),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams
plot_nams <-ggplot(data = TabFemmesExpAN,
aes(x =sexe,
y = value, fill = forcats::fct_relevel(mandat, c("3e mandats et+", "2e mandat", "1er mandat"), after = 1))) +
geom_col() +
facet_wrap(annee) +
labs(title = "Taux d'emploi des femmes en fonction du niveau d'éducation",
subtitle = "Lecture : En 2018, les femmes allemandes avec un niveau d'éducation élevé ont un taux d'emploi de 87 %.  \nCalculs et graphiques : Namsie d'amour",
y = "Pourcentage", x = "Année") +
#scale_color_manual(name = "Composante", values=c("red","grey50","grey50","grey50","grey50","grey50")) +
theme_grey()+
theme(legend.position="bottom",
#axis.text.x = element_text(angle = 90),
legend.title = element_text(size=12),
legend.text = element_text(size=12),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams <-ggplot(data = TabFemmesExpAN,
aes(x =sexe,
y = value, fill = forcats::fct_relevel(mandat, c("3e mandats et+", "2e mandat", "1er mandat"), after = 1))) +
geom_col() +
facet_wrap(~annee) +
labs(title = "Taux d'emploi des femmes en fonction du niveau d'éducation",
subtitle = "Lecture : En 2018, les femmes allemandes avec un niveau d'éducation élevé ont un taux d'emploi de 87 %.  \nCalculs et graphiques : Namsie d'amour",
y = "Pourcentage", x = "Année") +
#scale_color_manual(name = "Composante", values=c("red","grey50","grey50","grey50","grey50","grey50")) +
theme_grey()+
theme(legend.position="bottom",
#axis.text.x = element_text(angle = 90),
legend.title = element_text(size=12),
legend.text = element_text(size=12),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", face = "italic")) +
scale_fill_discrete(name=NULL)
plot_nams
library(insee)
library(doremifasol)
library(eurostat)
library(OECD)
library(plyr)
library(dplyr)
library(ggplot2)
library(readxl)
library(writexl)
library(tsibble)
library(tibble)
library(janitor)
library(tsbox)
library(knitr)
library(tempdisagg)
library(labelled)
library(stringr)
library(Hmisc)
library(lubridate)
library(conflicted)
library(base)
library(tidyr)
conflict_prefer("rename", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("mutate", "dplyr")
conflict_prefer("arrange", "dplyr")
conflict_prefer("replace", "dplyr")
conflict_prefer("lag", "dplyr")
conflict_prefer("summarise", "dplyr")
conflict_prefer("relocate", "dplyr")
conflict_prefer("select", "dplyr")
setwd <- setwd("C:/Users/gasto/Documents/GitHub/Statjunior/projets-r-statjunior/chomage_bit/")
insee_dataset = get_dataset_list()
#########Chomage BIT et taux de chomage de longue durée
get_chom_bit =
get_idbank_list("CHOMAGE-TRIM-NATIONAL") %>%
filter(NATURE == "TAUX")
idbank_chom_bit = get_chom_bit %>% pull(idbank)
chom_bit =
get_insee_idbank(idbank_chom_bit) %>%
split_title() %>%
filter(OBS_STATUS == "A") %>%
select(DATE, TIME_PERIOD, OBS_VALUE, TITLE_FR1, TITLE_FR2, TITLE_FR3, TITLE_FR4, TITLE_FR5) %>%
filter(TITLE_FR3 == "France hors Mayotte")
p_chom_bit <- filter(chom_bit, TITLE_FR1 == "Taux de chômage au sens du BIT" | TITLE_FR1 == "Taux de chômage de longue durée")
p_chom_bit <- filter(p_chom_bit, TITLE_FR2 == "Ensemble")
p_chom_age <- filter(chom_bit, TITLE_FR1 == "Taux de chômage au sens du BIT") |>
filter(TITLE_FR2 == "Ensemble des 25 à 49 ans" | TITLE_FR2 =="Ensemble des moins de 25 ans" | TITLE_FR2 =="Ensemble des 50 ans ou plus")
####Plot Graphique chomage BIT et chomage de longue durée
plot_chom_bit_duree <-  ggplot(data=p_chom_bit, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = TITLE_FR1), size = 1.1)+
labs(title = "Taux de chômage au sens du BIT et taux de chômage de longue durée",
subtitle = "Lecture : Au 1er trimestre 2023, le taux de chômage au sens du BIT est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Taux de chômage au sens du BIT (%)", x = "Année", color=NULL) +
#scale_color_manual(values = c("#333333"))
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 16, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 12, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=12)
)
plot_chom_bit_duree
###Plot du chomage BIT par tranche d'age
plot_chom_bit_age <-  ggplot(data=p_chom_age, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = TITLE_FR2), size = 1.1)+
labs(title = "Taux de chômage au sens du BIT par tranche d'âge",
subtitle = "Lecture : Au 1er trimestre 2023, le taux de chômage au sens du BIT est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Taux de chômage au sens du BIT (%)", x = "Année", color=NULL) +
#scale_color_manual(values = c("#333333"))
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 16, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 12, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=12)
)
plot_chom_bit_age
############Chomage élargi (BIT + halo + sous-emploi)
get_elargi =
get_idbank_list("CHOMAGE-TRIM-NATIONAL") %>%
filter(NATURE == "PROPORTION")
idbank_chom_elargi = get_elargi %>% pull(idbank)
chom_elargi =
get_insee_idbank(idbank_chom_elargi) %>%
split_title() %>%
filter(OBS_STATUS == "A") %>%
select(DATE, TIME_PERIOD, OBS_VALUE, TITLE_FR1, TITLE_FR2, TITLE_FR3, TITLE_FR4, TITLE_FR5) %>%
filter(TITLE_FR3 == "France hors Mayotte")
p_chom_elargi <- filter(chom_elargi, TITLE_FR1 == "Part des chômeurs parmi les participants au marché du travail (emploi, chômage, halo)" |
TITLE_FR1 == "Part des personnes au chômage ou dans le halo parmi les participants (emploi, chômage, halo) au marché du travail" |
TITLE_FR1 ==  "Part des personnes contraintes sur leur offre de travail (halo, chômage, sous-emploi) parmi les participants au marché du travail (emploi, chômage, halo)") |>
mutate(TITLE_FR1 = case_when(
TITLE_FR1 == "Part des chômeurs parmi les participants au marché du travail (emploi, chômage, halo)"~"Chômage BIT",
TITLE_FR1 == "Part des personnes au chômage ou dans le halo parmi les participants (emploi, chômage, halo) au marché du travail"~"Chômage + halo du chomage",
TITLE_FR1 == "Part des personnes contraintes sur leur offre de travail (halo, chômage, sous-emploi) parmi les participants au marché du travail (emploi, chômage, halo)"~"Chômage + halo du chomage + sous-emploi"
))
####Plot contraintes sur l'offre de travail (chomage BIT + halo + sous-emploi)
plot_chom_elargi <-  ggplot(data=p_chom_elargi, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = TITLE_FR1), size =1.1)+
labs(title = "Contraintes sur l'offre de travail (chômage, halo du chômage et sous-emploi)",
subtitle = "Lecture : Au 1er trimestre 2023, les contraintes sur l'offre de travail (chômage BIT + halo + sous-emploi) représentent X % des participants au marché du travail.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part parmi les participants au marché du travail (%)", x = "Année", color=NULL) +
#scale_color_manual(values = c("#333333"))
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 16, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 12, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=12)
)
plot_chom_elargi
###Halo par tranche d'age
p_alo_age <- filter(chom_elargi, TITLE_FR1 == "Personnes dans le halo autour du chômage") |>
filter(TITLE_FR2 == "Ensemble de 25 à 49 ans (part dans la population)" |
TITLE_FR2 == "Ensemble de 15 à 24 ans (part dans la population)" |
TITLE_FR2 == "Ensemble de 50 à 64 ans (part dans la population)") |>
mutate(TITLE_FR2 = case_when(
TITLE_FR2 == "Ensemble de 25 à 49 ans (part dans la population)"~"25 - 49 ans",
TITLE_FR2 == "Ensemble de 15 à 24 ans (part dans la population)"~"15 - 24 ans",
TITLE_FR2 == "Ensemble de 50 à 64 ans (part dans la population)"~"50 - 64 ans"
))
###Plot halo par tranche d'age
plot_alo_age <-  ggplot(data=p_alo_age, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = TITLE_FR2), size =1.1)+
labs(title = "Halo du chômage par tranche d'âge",
subtitle = "Lecture : Au 1er trimestre 2023, les 50 - 64 ans dans le halo du chômage représentent X % de la population française.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 16, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 12, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=12)
)
plot_alo_age
####Taux d'emploi
list_emploi_bit =
get_idbank_list("EMPLOI-BIT-TRIM") %>%
filter(NATURE == "TAUX") %>%
filter(INDICATEUR_label_fr == "Taux d'emploi" |
INDICATEUR_label_fr == "Taux d'activité" |
INDICATEUR_label_fr == "Taux d'emploi à temps complet" |
INDICATEUR_label_fr == "Taux d'emploi à temps partiel" |
INDICATEUR_label_fr == "Taux d'emploi en CDD ou intérim" |
INDICATEUR_label_fr =="Taux d'emploi en CDI" |
INDICATEUR_label_fr =="Taux d'emploi en équivalent temps plein" |
INDICATEUR_label_fr =="Taux de personnes en situation de sous-emploi")
idbank_emploi_bit= list_emploi_bit%>% pull(idbank)
try_emploi_bit =
get_insee_idbank(idbank_emploi_bit) %>%
split_title() %>%
filter(OBS_STATUS == "A") %>%
filter(DATE == max(DATE)) %>%
pull(IDBANK)
emploi_bit =
get_insee_idbank(try_emploi_bit) %>%
split_title() %>%
filter(OBS_STATUS == "A")
emploi_bit <- emploi_bit |>
mutate(TITLE_FR2 = ifelse(IDBANK == "010605845",
"Ensemble", TITLE_FR2)) |>
mutate(TITLE_FR3 = ifelse(IDBANK == "010605845",
"France hors Mayotte", TITLE_FR3)) |>
mutate(TITLE_FR4 = ifelse(is.na(TITLE_FR4), "Données CVS", TITLE_FR4)) |>
mutate(age = str_extract(TITLE_FR2, "\\d{1,2} à \\d{1,2} ans")) |>
mutate(age = ifelse(TITLE_FR2 =="Ensemble des 50 ans ou plus", "50 ans ou plus", age)) |>
mutate(sexe = if_else(str_detect(TITLE_FR2, "Femmes"), "Femmes", "")) |>
mutate(sexe = if_else(str_detect(TITLE_FR2, "Hommes"), "Hommes", sexe)) |>
mutate(sexe = if_else(str_detect(TITLE_FR2, "Ensemble"), "Ensemble", sexe)) |>
mutate(sexe = if_else(str_detect(TITLE_FR2, "Total"), "Ensemble", sexe)) |>
mutate(age = ifelse(is.na(age), "Ensemble", age)) |>
mutate(TITLE_FR1 = case_when(
TITLE_FR1 =="Personnes actives (taux d'activité) au sens du BIT"~"Taux d'activité (BIT)",
TITLE_FR1 =="Taux des personnes en situation de sous-emploi"~"Taux de sous-emploi",
TITLE_FR1 =="Taux d'emploi en équivalent temps plein au sens du BIT"~"Taux d'emploi en EQTP",
TITLE_FR1 =="Taux d'emploi en contrat à durée indéterminée (CDI) au sens du BIT"~"Taux d'emploi en CDI",
TITLE_FR1 =="Taux d'emploi en contrat à durée déterminée (CDD) ou intérim au sens du BIT"~"Taux d'emploi en CDD ou intérim",
TITLE_FR1 =="Taux d'emploi à temps partiel au sens du BIT"~"Taux d'emploi à temps partiel",
TITLE_FR1 =="Taux d'emploi à temps complet au sens du BIT"~"Taux d'emploi à temps complet",
TITLE_FR1 =="Personnes en emploi (taux d'emploi) au sens du BIT"~"Taux d'emploi (BIT)"
))
###Taux d'emploi BIT
tx_emploi <- filter(emploi_bit, TITLE_FR1 == "Taux d'emploi (BIT)")
tx_emploi_sexe <- filter(tx_emploi, age =="15 à 64 ans" & (sexe == "Hommes" |sexe == "Femmes"))
tx_emploi_age <- filter(tx_emploi, sexe == "Ensemble") |>
filter(age == "15 à 24 ans" | age =="15 à 64 ans" |age =="25 à 49 ans" |age =="50 à 64 ans")
plot_tx_emploi_age <-  ggplot(data=tx_emploi_age, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = age), size =1.1)+
labs(title = "Taux d'emploi au sens du BIT par tranche d'âge",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi au sens du BIT des 15 - 64 ans est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_emploi_age
plot_tx_emploi_sexe <-  ggplot(data=tx_emploi_sexe, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = sexe), size =1.1)+
labs(title = "Taux d'emploi au sens du BIT par sexe",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi au sens du BIT des femmes est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_emploi_sexe
###Taux d'activité BIT
tx_act <- filter(emploi_bit, TITLE_FR1 == "Taux d'activité (BIT)")
tx_act_sexe <- filter(tx_act, age =="15 à 64 ans" & (sexe == "Hommes" |sexe == "Femmes"))
tx_act_age <- filter(tx_act, sexe == "Ensemble") |>
filter(age == "15 à 24 ans" | age =="15 à 64 ans" |age =="25 à 49 ans" |age =="50 à 64 ans")
plot_tx_act_age <-  ggplot(data=tx_act_age, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = age), size =1.1)+
labs(title = "Taux d'activité au sens du BIT par tranche d'âge",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'activité au sens du BIT des 15 - 64 ans est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_act_age
plot_tx_act_sexe <-  ggplot(data=tx_act_sexe, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = sexe), size =1.1)+
labs(title = "Taux d'activité au sens du BIT par sexe",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'activité au sens du BIT des femmes est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_act_sexe
###Taux d'emploi à temps complet
tx_complet <- filter(emploi_bit, TITLE_FR1 == "Taux d'emploi à temps complet")
tx_complet_sexe <- filter(tx_complet, age =="15 à 64 ans" & (sexe == "Hommes" |sexe == "Femmes"))
tx_complet_age <- filter(tx_complet, sexe == "Ensemble") |>
filter(age == "15 à 24 ans" | age =="15 à 64 ans" |age =="25 à 49 ans" |age =="50 à 64 ans")
plot_tx_complet_age <-  ggplot(data=tx_complet_age, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = age), size =1.1)+
labs(title = "Taux d'emploi à temps complet par tranche d'âge",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi à temps complet des 15 - 64 ans est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_complet_age
plot_tx_complet_sexe <-  ggplot(data=tx_complet_sexe, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = sexe), size =1.1)+
labs(title = "Taux d'emploi à temps complet par sexe",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi à temps complet des femmes est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
scale_y_continuous(breaks=seq(40,70,5))+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_complet_sexe
###Taux d'emploi à temps partiel
tx_partiel <- filter(emploi_bit, TITLE_FR1 == "Taux d'emploi à temps partiel")
tx_partiel_sexe <- filter(tx_partiel, age =="15 à 64 ans" & (sexe == "Hommes" |sexe == "Femmes"))
tx_partiel_age <- filter(tx_partiel, sexe == "Ensemble") |>
filter(age == "15 à 24 ans" | age =="15 à 64 ans" |age =="25 à 49 ans" |age =="50 à 64 ans")
plot_tx_partiel_age <-  ggplot(data=tx_partiel_age, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = age), size =1.1)+
labs(title = "Taux d'emploi à temps partiel par tranche d'âge",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi à temps partiel des 15 - 64 ans est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_partiel_age
plot_tx_partiel_sexe <-  ggplot(data=tx_partiel_sexe, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = sexe), size =1.1)+
labs(title = "Taux d'emploi à temps partiel par sexe",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi à temps partiel des femmes est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_partiel_sexe
###Taux d'emploi en CDI
tx_cdi_cdd <- filter(emploi_bit,  TITLE_FR1 == "Taux d'emploi en CDD ou intérim")
plot_tx_cdi_cdd <-  ggplot(data=tx_cdi_cdd, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = TITLE_FR1), size =1.1)+
labs(title = "Taux d'emploi en contrat à durée déterminée (CDD) ou intérim au sens du BIT",
subtitle = "Lecture : Au 1er trimestre 2023, les emplois en CDD ou intérim représentent X points du taux d'emploi d'ensemble.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Contribution au taux d'emploi d'ensemble (points de pourcentage)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
axis.text=element_text(size=11),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_cdi_cdd
###Taux d'emploi en EQTP
tx_emploi_eqtp <- filter(emploi_bit,  TITLE_FR1 == "Taux d'emploi en EQTP")
tx_emploi_eqtp_sexe <- filter(tx_emploi_eqtp, age =="15 à 64 ans" & (sexe == "Hommes" |sexe == "Femmes"))
tx_emploi_eqtp_age <- filter(tx_emploi_eqtp, sexe == "Ensemble") |>
filter(age == "15 à 24 ans" | age =="15 à 64 ans" |age =="25 à 49 ans" |age =="50 à 64 ans")
plot_tx_emploi_eqtp_age <-  ggplot(data=tx_emploi_eqtp_age, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = age), size =1.1)+
labs(title = "Taux d'emploi en équivalent temps plein (EQTP) par tranche d'âge",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi en EQTP des 15 - 64 ans est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_emploi_eqtp_age
plot_tx_emploi_eqtp_sexe <-  ggplot(data=tx_emploi_eqtp_sexe, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = sexe), size =1.1)+
labs(title = "Taux d'emploi en équivalent temps plein (EQTP) par sexe",
subtitle = "Lecture : Au 1er trimestre 2023, le taux d'emploi en EQTP des femmes est de X %.  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Part de la population (%)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
plot_tx_emploi_eqtp_sexe
###Sous-emploi
tx_ss_emploi <- filter(emploi_bit,  TITLE_FR1 == "Taux de sous-emploi")
tx_ss_emploi <-  ggplot(data=tx_ss_emploi, aes(x=DATE, y= OBS_VALUE)) +
geom_line(aes(y = OBS_VALUE, color = TITLE_FR1), size =1.1)+
labs(title = "Contribution du sous-emploi parmi le taux d'emploi",
subtitle = "Lecture : Au 1er trimestre 2023, la contribution du sous-emploi au taux d'emploi d'ensemble est de X % .  \nSource : Insee - Enquête Emploi (Dernier point : 1er trimestre 2023) \nGraphique : @statjunior",
y = "Contribution au taux d'emploi d'ensemble (points de pourcentage)", x = "Année", color=NULL) +
theme_grey()+
theme(legend.position="bottom",
axis.text=element_text(size=11),
plot.title = element_text(color = "#333333", size = 18, face = "bold"),
plot.subtitle = element_text(color = "#333333", size = 14, face = "italic"),
legend.title = element_text(size=12),
legend.text = element_text(size=14)
)
tx_ss_emploi
library(shiny); runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
runApp('rshiny_chom.R')
